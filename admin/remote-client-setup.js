"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const os = require("os");
const path = require("path");
const SYSTEMD_SERVICE_NAME = 'iobroker-ds18b20-remote.service';
const files = {
    'common.js': 'InVzZSBzdHJpY3QiOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwpleHBvcnRzLmRlY3J5cHQgPSBleHBvcnRzLmVuY3J5cHQgPSBleHBvcnRzLlJFTU9URV9QUk9UT0NPTF9WRVJTSU9OID0gdm9pZCAwOwpjb25zdCBjcnlwdG8gPSByZXF1aXJlKCJjcnlwdG8iKTsKZXhwb3J0cy5SRU1PVEVfUFJPVE9DT0xfVkVSU0lPTiA9IDE7CmNvbnN0IElWX0xFTkdUSCA9IDE2OwpmdW5jdGlvbiBlbmNyeXB0KHRleHQsIGtleSkgewogICAgY29uc3QgaXYgPSBjcnlwdG8ucmFuZG9tQnl0ZXMoSVZfTEVOR1RIKTsKICAgIGNvbnN0IGNpcGhlciA9IGNyeXB0by5jcmVhdGVDaXBoZXJpdignYWVzLTI1Ni1jYmMnLCBrZXksIGl2KTsKICAgIGxldCBlbmNyeXB0ZWQgPSBjaXBoZXIudXBkYXRlKHRleHQpOwogICAgZW5jcnlwdGVkID0gQnVmZmVyLmNvbmNhdChbZW5jcnlwdGVkLCBjaXBoZXIuZmluYWwoKV0pOwogICAgcmV0dXJuIGl2LnRvU3RyaW5nKCdoZXgnKSArICc6JyArIGVuY3J5cHRlZC50b1N0cmluZygnaGV4Jyk7Cn0KZXhwb3J0cy5lbmNyeXB0ID0gZW5jcnlwdDsKZnVuY3Rpb24gZGVjcnlwdCh0ZXh0LCBrZXkpIHsKICAgIGNvbnN0IHRleHRQYXJ0cyA9IHRleHQuc3BsaXQoJzonKTsKICAgIGNvbnN0IGl2ID0gQnVmZmVyLmZyb20odGV4dFBhcnRzLnNoaWZ0KCksICdoZXgnKTsKICAgIGNvbnN0IGVuY3J5cHRlZFRleHQgPSBCdWZmZXIuZnJvbSh0ZXh0UGFydHMuam9pbignOicpLCAnaGV4Jyk7CiAgICBjb25zdCBkZWNpcGhlciA9IGNyeXB0by5jcmVhdGVEZWNpcGhlcml2KCdhZXMtMjU2LWNiYycsIGtleSwgaXYpOwogICAgbGV0IGRlY3J5cHRlZCA9IGRlY2lwaGVyLnVwZGF0ZShlbmNyeXB0ZWRUZXh0KTsKICAgIGRlY3J5cHRlZCA9IEJ1ZmZlci5jb25jYXQoW2RlY3J5cHRlZCwgZGVjaXBoZXIuZmluYWwoKV0pOwogICAgcmV0dXJuIGRlY3J5cHRlZC50b1N0cmluZygpOwp9CmV4cG9ydHMuZGVjcnlwdCA9IGRlY3J5cHQ7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbW1vbi5qcy5tYXA=',
'ds18b20-remote-client.js': 'InVzZSBzdHJpY3QiOwp2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHsKICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfQogICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQogICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yWyJ0aHJvdyJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH0KICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQogICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTsKICAgIH0pOwp9OwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwpjb25zdCB1dGlsXzEgPSByZXF1aXJlKCJ1dGlsIik7CmNvbnN0IG5ldF8xID0gcmVxdWlyZSgibmV0Iik7CmNvbnN0IGZzID0gcmVxdWlyZSgiZnMiKTsKY29uc3Qgb3MgPSByZXF1aXJlKCJvcyIpOwpjb25zdCByZWFkRGlyID0gdXRpbF8xLnByb21pc2lmeShmcy5yZWFkZGlyKTsKY29uc3QgcmVhZEZpbGUgPSB1dGlsXzEucHJvbWlzaWZ5KGZzLnJlYWRGaWxlKTsKY29uc3QgbG9nZ2VyXzEgPSByZXF1aXJlKCIuL2xvZ2dlciIpOwpjb25zdCBjb21tb25fMSA9IHJlcXVpcmUoIi4vY29tbW9uIik7CmNvbnN0IEVOVl9LRVlTID0gWwogICAgJ0FEQVBURVJfSE9TVCcsCiAgICAnQURBUFRFUl9LRVknLAogICAgJ0FEQVBURVJfUE9SVCcsCiAgICAnREVCVUcnLAogICAgJ1NZU1RFTV9JRCcsCiAgICAnVzFfREVWSUNFU19QQVRIJywKXTsKY2xhc3MgRHMxOGIyMFJlbW90ZSB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICB0aGlzLnJlY29ubmVjdFRpbWVvdXQgPSBudWxsOwogICAgICAgIHRoaXMuc2hvdWxkRXhpdCA9IGZhbHNlOwogICAgICAgIHRoaXMucmVjdkRhdGEgPSAnJzsKICAgICAgICB0aGlzLmNvbm5lY3QgPSB0aGlzLmNvbm5lY3QuYmluZCh0aGlzKTsKICAgICAgICB0aGlzLmV4aXQgPSB0aGlzLmV4aXQuYmluZCh0aGlzKTsKICAgICAgICB0aGlzLm9uQ2xvc2UgPSB0aGlzLm9uQ2xvc2UuYmluZCh0aGlzKTsKICAgICAgICB0aGlzLm9uRGF0YSA9IHRoaXMub25EYXRhLmJpbmQodGhpcyk7CiAgICAgICAgdGhpcy5vbkVycm9yID0gdGhpcy5vbkVycm9yLmJpbmQodGhpcyk7CiAgICAgICAgdGhpcy5sb2cgPSBuZXcgbG9nZ2VyXzEuTG9nZ2VyKCk7CiAgICAgICAgdGhpcy5sb2cubG9nKCctIGlvQnJva2VyLmRzMThiMjAgcmVtb3RlIGNsaWVudCAtJyk7CiAgICAgICAgdGhpcy5yZWFkRG90RW52KCk7CiAgICAgICAgaWYgKHByb2Nlc3MuZW52LlNZU1RFTV9JRCkgewogICAgICAgICAgICB0aGlzLnN5c3RlbUlkID0gcHJvY2Vzcy5lbnYuU1lTVEVNX0lELnRyaW0oKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHRoaXMuc3lzdGVtSWQgPSBvcy5ob3N0bmFtZSgpOwogICAgICAgICAgICB0aGlzLmxvZy53YXJuKGBVc2luZyB0aGUgaG9zdG5hbWUgJHt0aGlzLnN5c3RlbUlkfSBhcyBzeXN0ZW0gSUQuIFBsZWFzZSBzZXQgU1lTVEVNX0lEIHRvIGEgdW5pcXVlIHZhbHVlLmApOwogICAgICAgIH0KICAgICAgICB0aGlzLmxvZy5kZWJ1Zyhgc3lzdGVtSWRgLCB0aGlzLnN5c3RlbUlkKTsKICAgICAgICBpZiAocHJvY2Vzcy5lbnYuQURBUFRFUl9QT1JUKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB0aGlzLmFkYXB0ZXJQb3J0ID0gcGFyc2VJbnQocHJvY2Vzcy5lbnYuQURBUFRFUl9QT1JULCAxMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgdGhpcy5sb2cuZXJyb3IoYEludmFsaWQgQURBUFRFUl9QT1JUIWAsIGVycik7CiAgICAgICAgICAgICAgICBwcm9jZXNzLmV4aXQoMSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHRoaXMuYWRhcHRlclBvcnQgPSAxODIwOwogICAgICAgIH0KICAgICAgICB0aGlzLmxvZy5kZWJ1ZyhgYWRhcHRlclBvcnRgLCB0aGlzLmFkYXB0ZXJQb3J0KTsKICAgICAgICB0aGlzLmFkYXB0ZXJIb3N0ID0gKHByb2Nlc3MuZW52LkFEQVBURVJfSE9TVCB8fCAnJykudHJpbSgpOwogICAgICAgIGlmICh0aGlzLmFkYXB0ZXJIb3N0Lmxlbmd0aCA8PSAwKSB7CiAgICAgICAgICAgIHRoaXMubG9nLmVycm9yKGBObyBBREFQVEVSX0hPU1QgZ2l2ZW4hYCk7CiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCgxKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5sb2cuZGVidWcoYGFkYXB0ZXJIb3N0YCwgdGhpcy5hZGFwdGVySG9zdCk7CiAgICAgICAgdGhpcy5hZGFwdGVyS2V5ID0gQnVmZmVyLmZyb20ocHJvY2Vzcy5lbnYuQURBUFRFUl9LRVkgfHwgJycsICdoZXgnKTsKICAgICAgICBpZiAodGhpcy5hZGFwdGVyS2V5Lmxlbmd0aCAhPT0gMzIpIHsKICAgICAgICAgICAgdGhpcy5sb2cuZXJyb3IoYEFEQVBURVJfS0VZIGlzIG5vIHZhbGlkIGtleSFgKTsKICAgICAgICAgICAgcHJvY2Vzcy5leGl0KDEpOwogICAgICAgIH0KICAgICAgICB0aGlzLmxvZy5kZWJ1ZyhgYWRhcHRlcktleWAsIHRoaXMuYWRhcHRlcktleSk7CiAgICAgICAgdGhpcy53MURldmljZXNQYXRoID0gcHJvY2Vzcy5lbnYuVzFfREVWSUNFU19QQVRIIHx8ICcvc3lzL2J1cy93MS9kZXZpY2VzJzsKICAgICAgICBpZiAoIWZzLmV4aXN0c1N5bmModGhpcy53MURldmljZXNQYXRoKSkgewogICAgICAgICAgICB0aGlzLmxvZy5lcnJvcihgVGhlIDEtd2lyZSBkZXZpY2VzIHBhdGggJHt0aGlzLncxRGV2aWNlc1BhdGh9IGRvZXMgbm90IGV4aXN0IWApOwogICAgICAgICAgICBwcm9jZXNzLmV4aXQoMSk7CiAgICAgICAgfQogICAgICAgIHRoaXMubG9nLmRlYnVnKGB3MURldmljZXNQYXRoYCwgdGhpcy53MURldmljZXNQYXRoKTsKICAgICAgICBwcm9jZXNzLm9uKCdTSUdJTlQnLCB0aGlzLmV4aXQpOwogICAgICAgIHByb2Nlc3Mub24oJ1NJR1RFUk0nLCB0aGlzLmV4aXQpOwogICAgICAgIHRoaXMuc29ja2V0ID0gbmV3IG5ldF8xLlNvY2tldCgpOwogICAgICAgIHRoaXMuc29ja2V0Lm9uKCdjbG9zZScsIHRoaXMub25DbG9zZSk7CiAgICAgICAgdGhpcy5zb2NrZXQub24oJ2RhdGEnLCB0aGlzLm9uRGF0YSk7CiAgICAgICAgdGhpcy5zb2NrZXQub24oJ2Vycm9yJywgdGhpcy5vbkVycm9yKTsKICAgICAgICB0aGlzLmNvbm5lY3QoKTsKICAgIH0KICAgIGNvbm5lY3QoKSB7CiAgICAgICAgaWYgKHRoaXMucmVjb25uZWN0VGltZW91dCkgewogICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZWNvbm5lY3RUaW1lb3V0KTsKICAgICAgICAgICAgdGhpcy5yZWNvbm5lY3RUaW1lb3V0ID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuc2hvdWxkRXhpdCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMubG9nLmluZm8oYENvbm5lY3RpbmcgdG8gJHt0aGlzLmFkYXB0ZXJIb3N0fToke3RoaXMuYWRhcHRlclBvcnR9IC4uLmApOwogICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3QoewogICAgICAgICAgICBob3N0OiB0aGlzLmFkYXB0ZXJIb3N0LAogICAgICAgICAgICBwb3J0OiB0aGlzLmFkYXB0ZXJQb3J0LAogICAgICAgIH0sICgpID0+IHsKICAgICAgICAgICAgdGhpcy5sb2cuaW5mbyhgQ29ubmVjdGVkIHdpdGggYWRhcHRlcmApOwogICAgICAgICAgICBpZiAodGhpcy5yZWNvbm5lY3RUaW1lb3V0KSB7CiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZWNvbm5lY3RUaW1lb3V0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnJlY29ubmVjdFRpbWVvdXQgPSBudWxsOwogICAgICAgIH0pOwogICAgfQogICAgb25EYXRhKGRhdGEpIHsKICAgICAgICB0aGlzLnJlY3ZEYXRhICs9IGRhdGEudG9TdHJpbmcoKTsKICAgICAgICBsZXQgaWR4ID0gdGhpcy5yZWN2RGF0YS5pbmRleE9mKCdcbicpOwogICAgICAgIHdoaWxlIChpZHggPiAwKSB7CiAgICAgICAgICAgIGNvbnN0IHJhdyA9IHRoaXMucmVjdkRhdGEuc2xpY2UoMCwgaWR4KTsKICAgICAgICAgICAgdGhpcy5yZWN2RGF0YSA9IHRoaXMucmVjdkRhdGEuc2xpY2UoaWR4ICsgMSk7CiAgICAgICAgICAgIHRoaXMuaGFuZGxlU29ja2V0RGF0YShyYXcpOwogICAgICAgICAgICBpZHggPSB0aGlzLnJlY3ZEYXRhLmluZGV4T2YoJ1xuJyk7CiAgICAgICAgfQogICAgfQogICAgaGFuZGxlU29ja2V0RGF0YShyYXcpIHsKICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgewogICAgICAgICAgICBsZXQgZGF0YTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFTdHIgPSBjb21tb25fMS5kZWNyeXB0KHJhdywgdGhpcy5hZGFwdGVyS2V5KTsKICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRhdGFTdHIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIHRoaXMubG9nLndhcm4oYERlY3J5cHQgb2YgZGF0YSBmYWlsZWQhICR7ZXJyLnRvU3RyaW5nKCl9YCk7CiAgICAgICAgICAgICAgICB0aGlzLnNvY2tldC5lbmQoKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmxvZy5kZWJ1ZygnbWVzc2FnZSBmcm9tIGFkYXB0ZXI6JywgZGF0YSk7CiAgICAgICAgICAgIHN3aXRjaCAoZGF0YS5jbWQpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ2NsaWVudEluZm8nOgogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnByb3RvY29sVmVyc2lvbiAhPT0gY29tbW9uXzEuUkVNT1RFX1BST1RPQ09MX1ZFUlNJT04pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2cud2FybihgUHJvdG9jb2wgdmVyc2lvbiAke2RhdGEucHJvdG9jb2xWZXJzaW9ufSBmcm9tIHRoZSBhZGFwdGVyIGRvZXMgbm90IG1hdGNoIHRoZSByZW1vdGUgY2xpZW50IHByb3RvY29sIHZlcnNpb24gJHtjb21tb25fMS5SRU1PVEVfUFJPVE9DT0xfVkVSU0lPTn0hIFBsZWFzZSByZWluc3RhbGwgdGhlIHJlbW90ZSBjbGllbnQuYCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMubG9nLmluZm8oJ1NlbmRpbmcgY2xpZW50IGluZm8gdG8gdGhlIGFkYXB0ZXInKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbmQoewogICAgICAgICAgICAgICAgICAgICAgICBjbWQ6ICdjbGllbnRJbmZvJywKICAgICAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2xWZXJzaW9uOiBjb21tb25fMS5SRU1PVEVfUFJPVE9DT0xfVkVSU0lPTiwKICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtSWQ6IHRoaXMuc3lzdGVtSWQsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdyZWFkJzoKICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEuYWRkcmVzcykgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZy53YXJuKGBHb3QgcmVhZCBjb21tYW5kIHdpdGhvdXQgYWRkcmVzcyBmcm9tIGFkYXB0ZXIhYCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbGV0IHJhdzsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICByYXcgPSB5aWVsZCByZWFkRmlsZShgJHt0aGlzLncxRGV2aWNlc1BhdGh9LyR7ZGF0YS5hZGRyZXNzfS93MV9zbGF2ZWAsICd1dGY4Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nLmRlYnVnKGBSZWFkIGZyb20gZmlsZSAke3RoaXMudzFEZXZpY2VzUGF0aH0vJHtkYXRhLmFkZHJlc3N9L3cxX3NsYXZlOmAsIHJhdyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2cud2FybihgUmVhZCBmcm9tIGZpbGUgJHt0aGlzLncxRGV2aWNlc1BhdGh9LyR7ZGF0YS5hZGRyZXNzfS93MV9zbGF2ZSBmYWlsZWQhICR7ZXJyLnRvU3RyaW5nKCl9YCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nLmRlYnVnKGVycik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJhdyA9ICcnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmQoewogICAgICAgICAgICAgICAgICAgICAgICBjbWQ6ICdyZWFkJywKICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzczogZGF0YS5hZGRyZXNzLAogICAgICAgICAgICAgICAgICAgICAgICB0czogZGF0YS50cywKICAgICAgICAgICAgICAgICAgICAgICAgcmF3LAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnc2VhcmNoJzoKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlcyA9IHlpZWxkIHJlYWREaXIodGhpcy53MURldmljZXNQYXRoKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvbXMgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWxlc1tpXS5tYXRjaCgvXncxX2J1c19tYXN0ZXJcZCskLykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nLmRlYnVnKGByZWFkaW5nICR7dGhpcy53MURldmljZXNQYXRofS8ke2ZpbGVzW2ldfS93MV9tYXN0ZXJfc2xhdmVzYCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9tcy5wdXNoKHJlYWRGaWxlKGAke3RoaXMudzFEZXZpY2VzUGF0aH0vJHtmaWxlc1tpXX0vdzFfbWFzdGVyX3NsYXZlc2AsICd1dGY4JykpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkZHJlc3NlcyA9ICh5aWVsZCBQcm9taXNlLmFsbChwcm9tcykpLnJlZHVjZSgoYWNjLCBjdXIpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjYy5wdXNoKC4uLmN1ci50cmltKCkuc3BsaXQoJ1xuJykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgICAgICAgICAgICAgICAgICAgfSwgW10pOwogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmQoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kOiAnc2VhcmNoJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRzOiBkYXRhLnRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtSWQ6IGRhdGEuc3lzdGVtSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzZXMKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2cud2FybihgU2VhcmNoaW5nIGZvciBzZW5zb3JzIGZhaWxlZCEgJHtlcnIudG9TdHJpbmcoKX1gKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2cuZGVidWcoZXJyKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIHRoaXMubG9nLndhcm4oYFVua25vd24gY29tbWFuZCBmcm9tIGFkYXB0ZXJgKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQogICAgb25FcnJvcihlcnIpIHsKICAgICAgICB0aGlzLmxvZy53YXJuKGBTb2NrZXQgZXJyb3I6YCwgZXJyLnRvU3RyaW5nKCkpOwogICAgICAgIHRoaXMubG9nLmRlYnVnKGVycik7CiAgICAgICAgdGhpcy5zb2NrZXQuZW5kKCk7CiAgICAgICAgdGhpcy5yZWNvbm5lY3QoKTsKICAgIH0KICAgIG9uQ2xvc2UoKSB7CiAgICAgICAgdGhpcy5sb2cuaW5mbygnU29ja2V0IGNsb3NlZCcpOwogICAgICAgIHRoaXMucmVjb25uZWN0KCk7CiAgICB9CiAgICByZWNvbm5lY3QoKSB7CiAgICAgICAgaWYgKCF0aGlzLnJlY29ubmVjdFRpbWVvdXQgJiYgIXRoaXMuc2hvdWxkRXhpdCkgewogICAgICAgICAgICB0aGlzLmxvZy5pbmZvKGBSZWNvbm5lY3QgaW4gMzAgc2Vjb25kc2ApOwogICAgICAgICAgICB0aGlzLnJlY29ubmVjdFRpbWVvdXQgPSBzZXRUaW1lb3V0KHRoaXMuY29ubmVjdCwgMzAwMDApOwogICAgICAgIH0KICAgIH0KICAgIHNlbmQoZGF0YSkgewogICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7CiAgICAgICAgICAgIHRoaXMubG9nLmRlYnVnKCdzZW5kIHRvIGFkYXB0ZXI6JywgZGF0YSk7CiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnNvY2tldC53cml0ZShjb21tb25fMS5lbmNyeXB0KEpTT04uc3RyaW5naWZ5KGRhdGEpLCB0aGlzLmFkYXB0ZXJLZXkpICsgJ1xuJywgKGVycikgPT4gewogICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfQogICAgcmVhZERvdEVudigpIHsKICAgICAgICBpZiAoIWZzLmV4aXN0c1N5bmMoJy5lbnYnKSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGxldCBkYXRhOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMoJy5lbnYnLCAndXRmLTgnKS5zcGxpdCgnXG4nKS5tYXAoKGwpID0+IGwudHJpbSgpKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGVycikgewogICAgICAgICAgICB0aGlzLmxvZy5kZWJ1ZygnY2FuXCd0IHJlYWQgLmVudiBmaWxlJywgZXJyKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgZGF0YSkgewogICAgICAgICAgICBpZiAoIWxpbmUgfHwgbGluZS5zdGFydHNXaXRoKCcjJykpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgY29uc3QgaWR4ID0gbGluZS5pbmRleE9mKCc9Jyk7CiAgICAgICAgICAgIGlmIChpZHggPD0gMCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBjb25zdCBrZXkgPSBsaW5lLnNsaWNlKDAsIGlkeCkudHJpbSgpOwogICAgICAgICAgICBjb25zdCB2YWwgPSBsaW5lLnNsaWNlKGlkeCArIDEpLnRyaW0oKS5yZXBsYWNlKC8oXiJ8IiQpL2csICcnKTsKICAgICAgICAgICAgaWYgKEVOVl9LRVlTLmluZGV4T2Yoa2V5KSA+PSAwKSB7CiAgICAgICAgICAgICAgICBpZiAocHJvY2Vzcy5lbnZba2V5XSkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIHByb2Nlc3MuZW52W2tleV0gPSB2YWw7CiAgICAgICAgICAgICAgICB0aGlzLmxvZy5kZWJ1ZyhgcmVhZCAke2tleX09JHt2YWx9IGZyb20gLmVudiBmaWxlYCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBleGl0KCkgewogICAgICAgIHRoaXMuc2hvdWxkRXhpdCA9IHRydWU7CiAgICAgICAgaWYgKHRoaXMucmVjb25uZWN0VGltZW91dCkgewogICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZWNvbm5lY3RUaW1lb3V0KTsKICAgICAgICB9CiAgICAgICAgdGhpcy5zb2NrZXQuZW5kKCk7CiAgICB9Cn0KbmV3IERzMThiMjBSZW1vdGUoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZHMxOGIyMC1yZW1vdGUtY2xpZW50LmpzLm1hcA==',
'logger.js': 'InVzZSBzdHJpY3QiOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwpleHBvcnRzLkxvZ2dlciA9IHZvaWQgMDsKY2xhc3MgTG9nZ2VyIHsKICAgIGxvZyguLi5hcmdzKSB7CiAgICAgICAgY29uc29sZS5sb2coLi4uYXJncyk7CiAgICB9CiAgICBkZWJ1ZyguLi5hcmdzKSB7CiAgICAgICAgaWYgKCFwcm9jZXNzLmVudi5ERUJVRykgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCdbRGVidWddJywgLi4uYXJncyk7CiAgICB9CiAgICBpbmZvKC4uLmFyZ3MpIHsKICAgICAgICBjb25zb2xlLmxvZygnW0luZm9dJywgLi4uYXJncyk7CiAgICB9CiAgICB3YXJuKC4uLmFyZ3MpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1tXYXJuXScsIC4uLmFyZ3MpOwogICAgfQogICAgZXJyb3IoLi4uYXJncykgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tFcnJvcl0nLCAuLi5hcmdzKTsKICAgIH0KfQpleHBvcnRzLkxvZ2dlciA9IExvZ2dlcjsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nZ2VyLmpzLm1hcA=='
};
for (const f in files) {
    const content = Buffer.from(files[f], 'base64').toString('utf-8');
    fs.writeFileSync(f, content, { encoding: 'utf-8' });
}
const systemDContent = `[Unit]
Description=ioBroker.ds18b20 remote client
Documentation=https://github.com/crycode-de/ioBroker.ds18b20
After=network.target

[Service]
Type=simple
User=${os.userInfo().username}
WorkingDirectory=${__dirname}
ExecStart=${process.execPath} ${path.join(__dirname, 'ds18b20-remote-client.js')}
Restart=on-failure

[Install]
WantedBy=multi-user.target
`;
const systemDFile = path.join(__dirname, SYSTEMD_SERVICE_NAME);
fs.writeFileSync(systemDFile, systemDContent, { encoding: 'utf-8' });
const dotEnvContent = `# Settings for the ioBroker.ds18b20 remote client

# Unique ID for this remote system
SYSTEM_ID=my-remote

# IP or hostname of the ioBroker host running the adapter
ADAPTER_HOST=

# Port from the adapter config
ADAPTER_PORT=1820

# Encryption key from the adapter config
ADAPTER_KEY=

# Enable debug log output
#DEBUG=1

# System path of the 1-wire devices
#W1_DEVICES_PATH=/sys/bus/w1/devices
`;
const dotEnvFile = path.join(__dirname, '.env');
if (!fs.existsSync(dotEnvFile)) {
    fs.writeFileSync(dotEnvFile, dotEnvContent, { encoding: 'utf-8' });
}
console.log(`- ioBroker.ds18b20 remote client -

Basic setup done.

Please adjust the settings in the .env file.

To manually start the client just run:
  node ds18b20-remote-client.js

To setup the SystemD service, please run:
  sudo cp ${SYSTEMD_SERVICE_NAME} /etc/systemd/system/${SYSTEMD_SERVICE_NAME}
  sudo systemctl daemon-reload
  sudo systemctl enable ${SYSTEMD_SERVICE_NAME}
  sudo systemctl start ${SYSTEMD_SERVICE_NAME}
`);
//# sourceMappingURL=setup.js.map